<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CueCode</title>
  <link rel="shortcut icon" type="image/png" href="../images/logos/favicon.svg" />
  <link rel="stylesheet" href="../libs/owl.carousel/dist/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="../libs/aos-master/dist/aos.css">
  <link rel="stylesheet" href="../css/styles.css" />
  <!-- JWT 디코딩을 위한 라이브러리 추가 -->
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.min.js"></script>

  <style>
    .services-tab {
      .nav-tabs {
        .nav-item {
          .nav-link {
            color: #423c3c;

            &.active {
              background-color: transparent;
              color: #6FC8F8;
            }
          }
        }
      }
    }

    .text-primary {
      --bs-text-opacity: 1;
      color: rgb(111, 200, 248) !important;
    }

    .bg-primary {
      --bs-bg-opacity: 1;
      background-color: rgba(var(--bs-primary-rgb), var(--bs-bg-opacity)) !important;
    }

    /* 대시보드 링크 호버 효과 */
    .dashboard-link {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.5rem 1.2rem;
      border-radius: 2rem;
      background: #6FC8F8;
      min-width: 120px;
      max-width: 100%;
      box-sizing: border-box;
      text-decoration: none;
      transition: background 0.3s, box-shadow 0.3s;
      overflow: hidden;
    }

    .dashboard-link:hover {
      background: #5AB1E3;
      box-shadow: 0 5px 15px rgba(111, 200, 248, 0.4);
    }

    .dashboard-text {
      font-size: 1.1rem;
      font-weight: 600;
      white-space: nowrap;
      flex: 1 1 auto;
      transition: color 0.3s, transform 0.3s;
    }

    .dashboard-link:hover .dashboard-text {
      color: #fff;
      transform: scale(1.05);
    }

    .dashboard-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.2rem;
      height: 2.2rem;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 2px 8px rgba(111, 200, 248, 0.15);
      transition: background 0.3s, transform 0.3s;
      flex-shrink: 0;
      margin-left: auto;
    }

    .dashboard-link:hover .dashboard-icon {
      background: #ffeb3b;
      transform: translateX(5px);
    }

    .dashboard-icon iconify-icon {
      font-size: 1.3rem;
      color: #222;
      width: 1.3rem;
      height: 1.3rem;
      display: block;
      margin: 0 auto;
    }

    .dashboard-link:hover .dashboard-icon iconify-icon {
      color: #ff6b00;
      transform: rotate(45deg);
    }

    @media (max-width: 768px) {
      .dashboard-link {
        padding: 0.4rem 0.8rem;
        min-width: 90px;
      }

      .dashboard-icon {
        width: 1.7rem;
        height: 1.7rem;
      }

      .dashboard-icon iconify-icon {
        font-size: 1rem;
        width: 1rem;
        height: 1rem;
      }
    }

    @media (max-width: 480px) {
      .dashboard-link {
        padding: 0.3rem 0.5rem;
        min-width: 70px;
      }

      .dashboard-icon {
        width: 1.2rem;
        height: 1.2rem;
      }

      .dashboard-icon iconify-icon {
        font-size: 0.8rem;
        width: 0.8rem;
        height: 0.8rem;
      }
    }
  </style>
</head>

<body>

<!-- Header -->
<header class="header border-4 border-primary border-top position-fixed start-0 top-0 w-100">
  <div class="container">
    <div class="header-wrapper d-flex align-items-center justify-content-between">
      <div class="logo">
        <a href="index.html" class="logo-white">
          <img src="../images/logos/logo-white.svg" alt="logo" class="img-fluid">
        </a>
        <a href="index.html" class="logo-dark">
          <img src="../images/logos/logo-dark.svg" alt="logo" class="img-fluid">
        </a>
      </div>
      <div class="d-flex align-items-center gap-4">

        <div class="btn-group">
          <button
                  class="btn btn-secondary toggle-menu round-45 p-2 d-flex align-items-center justify-content-center bg-white rounded-circle"
                  type="button" data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false">
            <iconify-icon icon="solar:hamburger-menu-line-duotone" class="menu-icon fs-8 text-dark"></iconify-icon>
          </button>
          <ul class="dropdown-menu dropdown-menu-end p-4">
            <div class="d-flex flex-column gap-6">
              <div class="hstack justify-content-between border-bottom pb-6">
                <p class="mb-0 fs-5 text-dark">Menu</p>
                <button type="button" class="btn-close opacity-75" aria-label="Close"></button>
              </div>
              <div class="d-flex flex-column gap-3">
                <ul class="header-menu list-unstyled mb-0 d-flex flex-column gap-2">
                  <li class="header-item">
                    <a href="index.html" aria-current="true"
                       class="header-link active hstack gap-2 fs-7 fw-bold text-dark"><img
                            src="../images/svgs/secondary-leaf.svg" alt="" width="20" height="20"
                            class="img-fluid animate-spin">홈</a>
                  </li>
                  <li class="header-item">
                    <a href="about-us.html" class="header-link hstack gap-2 fs-7 fw-bold text-dark"><img
                            src="../images/svgs/secondary-leaf.svg" alt="" width="20" height="20"
                            class="img-fluid animate-spin">환자 대시보드</a>
                  </li>
                  <li class="header-item">
                    <a href="projects.html" class="header-link hstack gap-2 fs-7 fw-bold text-dark"><img
                            src="../images/svgs/secondary-leaf.svg" alt="" width="20" height="20"
                            class="img-fluid animate-spin">보호자 대시보드</a>
                  </li>
                  <li class="header-item" id="myPageMenuItem">
                    <a href="mypage.html" class="header-link hstack gap-2 fs-7 fw-bold text-dark" id="myPageMenuLinkAnchor"><img
                            src="../images/svgs/secondary-leaf.svg" alt="" width="20" height="20"
                            class="img-fluid animate-spin">마이 페이지</a>
                  </li>

                </ul>
                <div class="hstack gap-3" id="auth-btn-group">
                  <a href="sign-in.html"
                     class="btn btn-outline-light fs-6 bg-white px-3 py-2 text-dark w-50 hstack justify-content-center">로그인</a>
                  <a href="sign-up.html"
                     class="btn btn-dark text-white fs-6 bg-dark px-3 py-2 w-50 hstack justify-content-center">회원가입</a>
                </div>
              </div>
<!--              <div>-->
<!--                <a class="text-dark" href="tel:+1-212-456-7890">+1-212-456-7890</a>-->
<!--                <a class="fs-8 text-dark fw-bold" href="mailto:info@wrappixel.com">info@wrappixel.com</a>-->
<!--              </div>-->
            </div>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>
<!--  </header>-->

<!--  Page Wrapper -->
<div class="page-wrapper overflow-hidden">

  <!--  Banner Section -->
  <section class="banner-section position-relative d-flex align-items-end min-vh-100">
    <video class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover" autoplay muted loop playsinline>
      <source src="../images/backgrounds/cuecode-video1.mp4" type="video/mp4" />
    </video>
    <div class="container">
      <div class="d-flex flex-column gap-4 pb-8 position-relative z-1">
        <div class="row align-items-center">
          <div class="col-xl-4">
            <div class="d-flex align-items-center gap-4" data-aos="fade-up" data-aos-delay="100"
                 data-aos-duration="1000">
              <img src="../images/svgs/primary-leaf.svg" alt="" class="img-fluid animate-spin">
              <p class="mb-0 text-white fs-5 text-opacity-70">말하지 않아도, <span
                      class="text-primary">전하고 싶은 이야기</span>가 모두에게 닿을 수 있도록</p>
            </div>
          </div>
        </div>
        <div class="d-flex align-items-end gap-3" data-aos="fade-up" data-aos-delay="200" data-aos-duration="1000">
          <h1 class="mb-0 fs-16 text-white lh-1">CueCode</h1>
          <a href="javascript:void(0)" class="d-flex align-items-center bg-primary rounded-pill dashboard-link" id="dashboardLink">
            <span class="text-white me-1 dashboard-text" id="dashboardText"></span>
            <span class="dashboard-icon">
              <iconify-icon icon="lucide:arrow-up-right"></iconify-icon>
            </span>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!--  Stats & Facts Section -->
  <section class="stats-facts py-5 py-lg-11 py-xl-12 position-relative overflow-hidden">
    <div class="container">
      <div class="row gap-7 gap-xl-0">
        <div class="col-xl-4 col-xxl-4">
          <div class="d-flex align-items-center gap-7 py-2" data-aos="fade-right" data-aos-delay="100"
               data-aos-duration="1000">
              <span
                      class="round-36 flex-shrink-0 text-dark rounded-circle bg-primary hstack justify-content-center fw-medium">01</span>
            <hr class="border-line">
            <span class="badge text-bg-dark">Stats & facts</span>
          </div>
        </div>
        <div class="col-xl-8 col-xxl-7">
          <div class="d-flex flex-column gap-9">
            <div class="row">
              <div class="col-xxl-12">
                <div class="d-flex flex-column gap-6" data-aos="fade-up" data-aos-delay="100"
                     data-aos-duration="1000">
                  <h2 class="mb-0">제스처로 연결되는 우리의 이야기</h2>
                  <p class="fs-5 mb-0">CueCode는 손동작·얼굴 제스처 인식 기반 도구로 일상의
                    의사소통 장벽을 낮추고, 돌봄·교육·의료 현장의 연결을 돕습니다.</p>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 col-lg-4 mb-7 mb-lg-0">
                <div class="d-flex flex-column gap-6 pt-9 border-top" data-aos="fade-up" data-aos-delay="200"
                     data-aos-duration="1000">
                  <h2 class="mb-0 fs-14"><span class="count" data-target="40">1300</span>M+</h2>
                  <p class="mb-0">전 세계 중증 장애 인구(약 16%)</p>
                </div>
              </div>
              <div class="col-md-6 col-lg-4 mb-7 mb-lg-0">
                <div class="d-flex flex-column gap-6 pt-9 border-top" data-aos="fade-up" data-aos-delay="300"
                     data-aos-duration="1000">
                  <h2 class="mb-0 fs-14"><span class="count" data-target="97">97</span>M+</h2>
                  <p class="mb-0">전 세계 보완대체의사소통(AAC)<br>사용자 및 필요 인구</p>
                </div>
              </div>
              <div class="col-md-6 col-lg-4 mb-7 mb-lg-0">
                <div class="d-flex flex-column gap-6 pt-9 border-top" data-aos="fade-up" data-aos-delay="400"
                     data-aos-duration="1000">
                  <h2 class="mb-0 fs-14"><span class="count" data-target="70">70</span>%</h2>
                  <p class="mb-0">돌봄·의료 현장에서 소통 보조 필요 경험</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="position-absolute bottom-0 start-0" data-aos="zoom-in" data-aos-delay="100" data-aos-duration="1000">
      <!-- 존재하지 않는 이미지 참조를 제거하고 대체 이미지 사용 -->
<!--      <img src="../images/svgs/primary-leaf.svg" alt="" class="img-fluid">-->
    </div>
  </section>

  <!--  Services Section -->
  <section class="services py-5 py-lg-11 py-xl-12 bg-light-gray" >
    <div class="container">
      <div class="d-flex flex-column gap-5 gap-xl-10">
        <div class="row gap-7 gap-xl-0">
          <div class="col-xl-4 col-xxl-4">
            <div class="d-flex align-items-center gap-7 py-2" data-aos="fade-right" data-aos-delay="100"
                 data-aos-duration="1000">
                <span
                        class="round-36 flex-shrink-0 text-dark rounded-circle bg-primary hstack justify-content-center fw-medium">02</span>
              <hr class="border-line bg">
              <span class="badge text-dark bg-white">Services</span>
            </div>
          </div>
          <div class="col-xl-8 col-xxl-7">
            <div class="row">
              <div class="col-xxl-12">
                <div class="d-flex flex-column gap-6" data-aos="fade-up" data-aos-delay="100"
                     data-aos-duration="1000">
                  <h2 class="mb-0 ">What we do</h2>
                  <p class="fs-5 mb-0 text-opacity-70"> CueCode는 단순한 기술을 넘어, 모두가 자신의 목소리를 표현할 수 있는 권리를 현실로 만듭니다.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="services-tab">
          <div class="row gap-5 gap-xl-0">
            <div class="col-xl-4">
            </div>
            <div class="col-xl-8">
              <div class="d-flex flex-column gap-5">
                <ul class="nav nav-tabs" id="myTab" role="tablist" data-aos="fade-up" data-aos-delay="200"
                    data-aos-duration="1000">
                  <li
                          class="nav-item py-4 py-lg-8 border-top border-white border-opacity-10 d-flex align-items-center w-100"
                          role="presentation">
                    <div class="row w-100 align-items-center gx-3">
                      <div class="col-lg-6 col-xxl-5">
                        <button class="nav-link fs-10 fw-bold py-1 px-0 border-0 rounded-0 flex-shrink-0 active"
                                id="one-tab" data-bs-toggle="tab" data-bs-target="#one" type="button" role="tab"
                                aria-controls="one" aria-selected="true">제스처 인식</button>
                      </div>
                      <div class="col-lg-6 col-xxl-7">
                        <p class=" text-opacity-70 mb-0">
                          손동작, 눈 깜빡임, 얼굴의 미세한 움직임까지 실시간으로 인식합니다.
                          이 데이터는 단순한 동작으로 끝나지 않고, 시스템에서 즉시 문장이나 명령으로 변환되어 사용자에게 즉각적인 소통 도구가 됩니다.
                        </p>
                      </div>
                    </div>
                  </li>
                  <li
                          class="nav-item py-4 py-lg-8 border-top border-white border-opacity-10 d-flex align-items-center w-100"
                          role="presentation">
                    <div class="row w-100 align-items-center gx-3">
                      <div class="col-lg-6 col-xxl-5">
                        <button class="nav-link fs-10 fw-bold py-1 px-0 border-0 rounded-0 flex-shrink-0" id="two-tab"
                                data-bs-toggle="tab" data-bs-target="#two" type="button" role="tab" aria-controls="two"
                                aria-selected="false">사용자 정의 매핑</button>
                      </div>
                      <div class="col-lg-6 col-xxl-7">
                        <p class=" text-opacity-70 mb-0">
                          제스처와 의미(문장, 기능)를 직접 연결하여 개인화된 소통 방식을 설정할 수 있습니다.
                        </p>
                      </div>
                    </div>
                  </li>
                  <li
                          class="nav-item py-4 py-lg-8 border-top border-white border-opacity-10 d-flex align-items-center w-100"
                          role="presentation">
                    <div class="row w-100 align-items-center gx-3">
                      <div class="col-lg-6 col-xxl-5">
                        <button class="nav-link fs-10 fw-bold py-1 px-0 border-0 rounded-0 flex-shrink-0"
                                id="three-tab" data-bs-toggle="tab" data-bs-target="#three" type="button" role="tab"
                                aria-controls="three" aria-selected="false">영상분석</button>
                      </div>
                      <div class="col-lg-6 col-xxl-7">
                        <p class="text-opacity-70 mb-0">
                          업로드된 영상을 기반으로 제스처를 학습·분석하여 정확한 소통 지원을 제공합니다.
                        </p>
                      </div>
                    </div>
                  </li>
                  <li
                          class="nav-item py-4 py-lg-8 border-top border-white border-opacity-10 d-flex align-items-center w-100"
                          role="presentation">
                    <div class="row w-100 align-items-center gx-3">
                      <div class="col-lg-6 col-xxl-5">
                        <button class="nav-link fs-10 fw-bold py-1 px-0 border-0 rounded-0 flex-shrink-0"
                                id="four-tab" data-bs-toggle="tab" data-bs-target="#four" type="button" role="tab"
                                aria-controls="four" aria-selected="false">보호자·기관 대시보드</button>
                      </div>
                      <div class="col-lg-6 col-xxl-7">
                        <p class=" text-opacity-70 mb-0">
                          보호자와 기관은 대시보드를 통해 환자 관리가 가능하며,
                          실시간 도움 요청 알림을 받고 병원 DB(환자 번호 등)와 연동하여 안전한 돌봄을 지원합니다.
                        </p>
                      </div>
                    </div>
                  </li>
                </ul>

              </div> <!-- .d-flex flex-column gap-5 -->
            </div> <!-- .col-xl-8 -->
          </div> <!-- .row gap-5 gap-xl-0 -->
        </div> <!-- .services-tab -->
      </div> <!-- .d-flex flex-column gap-5 gap-xl-10 -->
    </div> <!-- .container -->
  </section>
  <!--  Get in touch Section -->
  <section class="get-in-touch py-5 py-lg-11 py-xl-12">
    <div class="container">
      <div class="d-flex flex-column gap-5 gap-xl-10">
        <div class="row gap-7 gap-xl-0">
          <div class="col-xl-4 col-xxl-4">
            <div class="d-flex align-items-center gap-7 py-2" data-aos="fade-right" data-aos-delay="100"
                 data-aos-duration="1000">
                <span
                        class="round-36 flex-shrink-0 text-dark rounded-circle bg-primary hstack justify-content-center fw-medium">3</span>
              <hr class="border-line bg-white">
              <span class="badge text-bg-dark">Contact us</span>
            </div>
          </div>
          <div class="col-xl-8 col-xxl-7">
            <div class="row">
              <div class="col-xxl-8">
                <div class="d-flex flex-column gap-6" data-aos="fade-up" data-aos-delay="100"
                     data-aos-duration="1000">
                  <h2 class="mb-0">Get in touch</h2>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row justify-content-between gap-7 gap-xl-0">
          <div class="col-xl-3">
            <p class="mb-0 fs-5" data-aos="fade-right" data-aos-delay="100" data-aos-duration="1000"> CueCode는 작은 ���빛과 손짓도 <b>소중한 목소리</b>가 될 수 있다고 믿습니다.
              마음속 이야기를 들려주세요. 언제나 귀 기울여 듣겠습니다.</p>
          </div>
          <div class="col-xl-8">
            <form class="d-flex flex-column gap-7" data-aos="fade-up" data-aos-delay="200" data-aos-duration="1000">
              <div>
                <input type="text" class="form-control border-bottom border-dark" id="formGroupExampleInput"
                       placeholder="Name">
              </div>
              <div>
                <input type="email" class="form-control border-bottom border-dark" id="exampleInputEmail1"
                       placeholder="Email" aria-describedby="emailHelp">
              </div>
              <div>
                  <textarea class="form-control border-bottom border-dark" id="exampleFormControlTextarea1"
                            placeholder="Tell us about our project" rows="3"></textarea>
              </div>
              <button type="submit" class="btn w-100 justify-content-center">
                <span class="btn-text">Submit message</span>
                <iconify-icon icon="lucide:arrow-up-right"
                              class="btn-icon bg-white text-dark round-52 rounded-circle hstack justify-content-center fs-7 shadow-sm"></iconify-icon>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

</div>

<footer class="footer bg-dark py-5 py-lg-11 py-xl-10">
  <div class="container">
    <div class="row">
      <div class="col-xl-5 mb-8 mb-xl-0">
        <div class="d-flex flex-column gap-8 pe-xl-5">
          <h4 class="mb-0 text-white">이 프로젝트는 <br> 개방형 클라우드 플랫폼(K-PaaS) 활용
            <br>공모전 출품작입니다</h4>
          <div class="d-flex flex-column gap-2">
            <a href="https://www.wrappixel.com/" target="_blank" class="link-hover hstack gap-3 text-white fs-5">
              <iconify-icon icon="lucide:arrow-up-right" class="fs-7 text-primary"></iconify-icon>
              https://contest.k-paas.org/
            </a>
            <a href="https://maps.app.goo.gl/hpDp81fqzGt5y4bC8" target="_blank"
               class="link-hover hstack gap-3 text-white fs-5">
              <iconify-icon icon="lucide:map-pin" class="fs-7 text-primary"></iconify-icon>
              우징산 산신령들
            </a>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-xl-2 mb-8 mb-xl-0">
        <ul class="footer-menu list-unstyled mb-0 d-flex flex-column gap-2">
          <li><a class="link-hover fs-5 text-white" href="index.html">홈</a></li>
          <li><a class="link-hover fs-5 text-white" href="about-us.html">환자 대시보드</a></li>
          <li><a class="link-hover fs-5 text-white" id="services" href="#services">보호자 대시보드</a></li>
<!--          <li><a class="link-hover fs-5 text-white" href="projects.html">마이 페이지</a></li>-->
<!--          <li><a class="link-hover fs-5 text-white" href="terms-and-conditions.html">Terms</a></li>-->
<!--          <li><a class="link-hover fs-5 text-white" href="privacy-policy.html">Privacy Policy</a></li>-->
<!--          <li><a class="link-hover fs-5 text-white" href="404.html">Error 404</a></li>-->
        </ul>
      </div>
<!--      <div class="col-md-4 col-xl-2 mb-8 mb-xl-0">-->
<!--        <ul class="footer-menu list-unstyled mb-0 d-flex flex-column gap-2">-->
<!--          <li><a class="link-hover fs-5 text-white" href="#!">Facebook</a></li>-->
<!--          <li><a class="link-hover fs-5 text-white" href="#!">Instagram</a></li>-->
<!--          <li><a class="link-hover fs-5 text-white" href="#!">Twitter</a></li>-->
<!--        </ul>-->
<!--      </div>-->
      <div class="col-md-4 col-xl-3 mb-8 mb-xl-0">
        <p class="mb-0 text-white text-opacity-70 text-md-end">© CueCode copyright 2025</p>
      </div>
    </div>
  </div>
  <p class="mb-0 text-white text-opacity-70 text-md-center mt-10">Distributed by <a class="text-white"  target="_blank">Team Ujangsan Spirit</a></p>
</footer>

<div class="get-template hstack gap-2">
  <button class="btn bg-primary p-2 round-52 rounded-circle hstack justify-content-center flex-shrink-0"
          id="scrollToTopBtn">
    <iconify-icon icon="lucide:arrow-up" class="fs-7 text-dark"></iconify-icon>
  </button>
</div>


<script src="../libs/jquery/dist/jquery.min.js"></script>
<script src="../libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../libs/owl.carousel/dist/owl.carousel.min.js"></script>
<script src="../libs/aos-master/dist/aos.js"></script>
<script src="../js/custom.js"></script>
<!-- solar icons -->
<script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>

<script>
  // --- [1] 유틸리티 함수 정의 ---
  function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) return parts.pop().split(';').shift();
    return null;
  }

  function removeCookie(name) {
    document.cookie = `${name}=; path=/; max-age=0;`;
  }

  // --- [2] 로그아웃 버튼 노출 함수 정의 ---
  function showLogoutButton(userName) {
    const authBtnGroup = document.getElementById('auth-btn-group');
    if (authBtnGroup) {
      // 이 부분을 dark 텍스트로 수정하여 헤더 토글 메뉴에서도 잘 보이게 조정합니다.
      authBtnGroup.innerHTML = `<span class="me-3 fw-bold text-dark">${userName ? userName + '님' : ''} 환영합니다!</span>
            <button id="logoutBtn" class="btn btn-outline-danger px-4 py-2">로그아웃</button>`; // ✅ px-3 -> px-4 수정
      document.getElementById('logoutBtn').onclick = function() {
        console.log('로그아웃 버튼 클릭: 토큰 삭제 및 로그인 페이지 이동');
        removeCookie('jwtAccessToken');
        removeCookie('jwtRefreshToken');
        window.location.href = 'sign-in.html';
      };
      console.log('로그아웃 버튼 노출 완료');
    }
  }

  // --- [3] DOMContentLoaded 메인 로직 (배너 버튼 및 헤더 버튼 변경) ---
  window.addEventListener('DOMContentLoaded', function() {
    const token = getCookie('jwtAccessToken');
    const dashboardLink = document.getElementById('dashboardLink');
    const dashboardText = document.getElementById('dashboardText');

    // 헤더 메뉴 링크 요소
    // ID 기반으로 다시 찾도록 수정: HTML에 ID를 추가했기 때문에 정확한 접근이 가능합니다.
    const patientMenuItem = document.getElementById('patientMenuItem');
    const managerMenuItem = document.getElementById('managerMenuItem');
    const myPageMenuItem = document.getElementById('myPageMenuItem');

    // <a> 태그 자체 (링크 변경을 위해 필요)
    const patientMenuLink = document.getElementById('patientMenuLink');
    const managerMenuLink = document.getElementById('managerMenuLink');
    const myPageMenuLinkAnchor = document.getElementById('myPageMenuLinkAnchor');

    console.log('쿠키에서 jwtAccessToken:', token ? '토큰 존재' : '토큰 없음');

    // 1. 미로그인 상태 처리
    if (!token) {
      console.log('미로그인 상태: 서비스 시작 버튼 설정');
      if (dashboardText) dashboardText.textContent = " "; // 텍스트를 " "에서 "서비스 시작"으로 복구
      if (dashboardLink) dashboardLink.href = 'sign-in.html';

      // 미로그인 상태에서는 대시보드와 마이페이지 메뉴를 숨김 (<li> 요소 숨김)
      if (patientMenuItem) patientMenuItem.style.display = 'none';
      if (managerMenuItem) managerMenuItem.style.display = 'none';
      if (myPageMenuItem) myPageMenuItem.style.display = 'none';

      return;
    }

    // 2. 로그인 상태 처리 (토큰 존재)
    let decoded = null;
    try {
      decoded = jwt_decode(token);
      console.log('토큰 디코딩 결과:', decoded);

      // ✅ 역할 클레임 병합: 'roles' 키의 값을 'role' 키로 사용
      decoded.role = decoded.role || decoded.roles;

    } catch (e) {
      console.error('토큰 디코딩 실패. 토큰 만료 또는 오류:', e);
      // 토큰 문제 발생 시 쿠키를 지우고 미로그인 상태로 복귀
      removeCookie('jwtAccessToken');
      window.location.reload();
      return;
    }

    // 3. 역할(ROLE)에 따른 배너/헤더 UI 변경
    if (decoded && decoded.role) { // 👈 이제 decoded.role을 사용하여 정상 분기
      let linkHref = 'index.html';
      let linkText = `${decoded.userName}님 대시보드`;

      // 모든 메뉴를 일단 숨기고, 역할에 맞는 메뉴만 표시 (<li> 요소 초기화)
      if (patientMenuItem) patientMenuItem.style.display = 'none';
      if (managerMenuItem) managerMenuItem.style.display = 'none';
      if (myPageMenuItem) myPageMenuItem.style.display = 'none';

      // 마이페이지는 로그인 시 항상 보이도록 설정
      if (myPageMenuItem && myPageMenuLinkAnchor) {
        myPageMenuLinkAnchor.href = 'mypage.html';
        myPageMenuItem.style.display = 'list-item'; // <li> 표시
      }

      // 환자 및 관리자 메뉴 링크 초기화 (나중에 링크를 사용할 수 있도록)
      if (patientMenuLink) patientMenuLink.href = 'patient-dashboard.html';
      if (managerMenuLink) managerMenuLink.href = '../manager/dashboard.html';


      if (decoded.role === 'ROLE_USER') {
        // 환자 역할
        linkHref = 'patient-dashboard.html';
        linkText = '환자 대시보드';
        if (patientMenuItem) {
          patientMenuItem.style.display = 'list-item'; // <li> 표시
        }
      } else if (decoded.role === 'ROLE_USER_MANAGER') {
        // 관리자(보호자) 역할
        linkHref = '../manager/dashboard.html'; // ✅ 수정된 올바른 상대 경로
        linkText = '보호자/관리자 대시보드';
        if (managerMenuItem) {
          managerMenuItem.style.display = 'list-item'; // <li> 표시
        }
      }

      // 배너 버튼 UI 업데이트
      if (dashboardLink) dashboardLink.href = linkHref;
      if (dashboardText) dashboardText.textContent = linkText;

      // 헤더의 로그인/로그아웃 버튼 업데이트
      showLogoutButton(decoded.userName);


    } else {
      console.log('로그인 상태지만 역할(role) 정보가 불분명함. 로그아웃 버튼만 노출.');
      if (dashboardText) dashboardText.textContent = "서비스 시작";

      // 역할 정보가 없어도 로그인 상태이므로 로그아웃 버튼은 보여줍니다.
      if (decoded && decoded.userName) {
        showLogoutButton(decoded.userName);
        // 역할이 불분명해도 마이페이지는 보이게 설정 (선택 사항)
        if (myPageMenuItem) myPageMenuItem.style.display = 'list-item';
      }
    }
  });
</script>
</body>

</html>
