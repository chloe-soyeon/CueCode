# devspace.sh configuration for MotionService
version: v1beta11

# 개발 워크플로우 정의
dev:
  # 로컬 PC의 15000번 포트를 컨테이너의 15000번 포트로 포워딩합니다.
  # 이를 통해 로컬 브라우저나 Postman으로 http://localhost:15000 접속이 가능해집니다.
  ports:
    - imageName: app
      forward:
        - port: 15000

  # 로컬의 소스코드를 컨테이너의 /app 디렉토리로 실시간 동기화합니다.
  sync:
    - imageName: app
      localSubPath: .
      containerPath: /app
      excludePaths:
        - .git
        - build
        - .gradle

  # devspace가 컨테이너 안에서 실행할 개발용 명령어입니다.
  # Spring Boot DevTools가 포함되어 있으면 코드 변경 시 자동으로 재시작됩니다.
  command:
    imageName: app
    command: "./gradlew bootRun"

# 배포할 쿠버네티스 매니페스트를 지정합니다.
deployments:
  - name: motion-service
    kubectl:
      manifests:
        - k8s/

# 개발에 사용할 컨테이너 이미지를 정의합니다.
images:
  app:
    image: openjdk:17-jdk-slim
